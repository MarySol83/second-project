Отток клиентов
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Нам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. Обучим разные модели классификации и найдем лучшую.

Построим модель с предельно большим значением F1-меры.

Дополнительно измерим AUC-ROC, сравним её значение с F1-мерой.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling.

Нам были предоставлены данные о поведении клиентов и расторжении договоров с банком. Нужно было спрогнозировать, уйдет клиент или нет.

В первоначальные данных наблюдался значительный дисбаланс (80% ответов целевого признака были негативными и только 20% позитивными), из-за чего обученная на этих данных модель не проходила проверку на адекватность. Все модели не первоначальных данных характеризовались высокой степенью ошибок и низким качеством взвешенной величины (F1) — модели показывали низкие результаты точности и полноты. Мы разобрали несколько вариантов борьбы с дисбалансом, в итоге устранили дисбаланс классов в обучающей выборки методом взвешивания.

На новых данных все модели показали результат выше, чем на несбалансированной выборке. Лучшие показатели были у модели случайного леса:

Recall: 0.6388140161725068

Precision: 0.6236842105263158

F1_score: 0.6311584553928096

ROC-AUC: 0.8553670086819258

Финальная модель также прошла проверку на адекватность в сравнении с контантной моделью:

accuracy_score константой модели: 0.7960

accuracy_score финальной модели: 0.8477

AUC-ROC константой модели: 0.5

AUC-ROC финальной модели: 0.8553

Таким образом, значения ключевых метрик получились следующие:

F1-score = 0.63 (выше необходимого значения)

AUC-ROC = 0.86 (достаточно близко к единице)